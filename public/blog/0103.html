<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>[JAR] Game ForgottenWarrior ‚Äî NeoJ's Web Page</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/a.css">
    <link rel="stylesheet" href="/pygments.css">
</head>
<body>
<header>
    <nav>
        <table width="620" border="1" class="center">
            <tbody>
            <tr>
                <td width="64" rowspan="2">
                    <img src="/avatar.png" width="64">
                </td>
                <td align="center" colspan="5">
                    <font size="5"><b><font color="#008000">NeoJ</font>'s Web Page</b></font>
                </td>
                <td width="100" align="center" rowspan="2">
                    Last Update:<br>
                </td>
            </tr>
            <tr>
                <td align="center" width="82">
                    <a href="/">Index</a>
                </td>
                <td class="active" align="center" width="82">
                    <a href="/">Blog</a>
                </td>
                <td align="center" width="82">
                    <a href="https://github.com/uk0">Projects</a>
                </td>
                <td align="center" width="82">
                    <a href="https://github.com/uk0">GitHub</a>
                </td>
                <td align="center" width="82">
                    <a href="/about/">About</a>
                </td>
            </tr>
            </tbody>
        </table>
    </nav>
</header>

<div class="page center">
    <h1 class="text_center">[JAR] Game ForgottenWarrior</h1>

    <p class="meta text_center">
        
    </p>
    <article>
        <h1>[JAR] Game <strong>ForgottenWarrior</strong></h1>
<div class="jar-player-wrapper" id="jar_dde9b5e8-wrapper">
  <style>
    #jar_dde9b5e8-wrapper {
      margin: 20px auto;
      padding: 20px;
      background: linear-gradient(135deg, #c2c2d9 0%, #16213e 100%);
      border-radius: 12px;
      max-width: fit-content;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }
<pre><code>#jar_dde9b5e8-wrapper .player-header {
  color: #fff;
  margin-bottom: 20px;
}

#jar_dde9b5e8-wrapper .player-header-top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 20px;
  margin-bottom: 10px;
}

#jar_dde9b5e8-wrapper .player-title {
  font-size: 18px;
  font-weight: 500;
  opacity: 0.9;
}

#jar_dde9b5e8-wrapper .player-controls {
  display: flex;
  gap: 8px;
}

#jar_dde9b5e8-wrapper .player-tip {
  font-size: 13px;
  color: rgba(255, 255, 255, 0.7);
  background: rgba(255, 255, 255, 0.1);
  padding: 6px 12px;
  border-radius: 6px;
  border-left: 3px solid #ffd700;
  display: flex;
  align-items: center;
  gap: 8px;
}

#jar_dde9b5e8-wrapper .player-tip .tip-icon {
  color: #ffd700;
  font-size: 16px;
}

#jar_dde9b5e8-wrapper .ctrl-btn {
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.2);
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 13px;
  transition: all 0.2s;
  text-decoration: none;
}

#jar_dde9b5e8-wrapper .ctrl-btn:hover {
  background: rgba(255, 255, 255, 0.2);
}

#jar_dde9b5e8-wrapper .ctrl-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

#jar_dde9b5e8-wrapper .ctrl-btn.success {
  background: rgba(76, 175, 80, 0.3);
  border-color: rgba(76, 175, 80, 0.5);
}

/* Main display container */
#jar_dde9b5e8-wrapper #display-container {
  background: #000;
  border-radius: 8px;
  padding: 10px;
  display: inline-block;
  position: relative;
}

#jar_dde9b5e8-wrapper #display {
  position: relative;
  background: #000;
}

#jar_dde9b5e8-wrapper #canvas {
  display: block;
  margin: 8px 100px;    /* Ê∞¥Âπ≥Â±Ö‰∏≠ */
  image-rendering: pixelated;
  image-rendering: -moz-crisp-edges;
  image-rendering: crisp-edges;
  background: #000;
}

/* J2ME.js screens */
#jar_dde9b5e8-wrapper .screen {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.95);
  color: #fff;
  text-align: center;
  padding: 20px;
  z-index: 10;
}

#jar_dde9b5e8-wrapper .screen.active {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

#jar_dde9b5e8-wrapper .screen .title {
  font-size: 16px;
  margin-bottom: 15px;
}

#jar_dde9b5e8-wrapper .screen progress {
  width: 200px;
  height: 4px;
}

/* Virtual keypad */
#jar_dde9b5e8-wrapper #keypad {
  margin-top: 15px;
  display: flex;
  justify-content: center;
  gap: 30px;
  user-select: none;
}

#jar_dde9b5e8-wrapper #joypad {
  display: inline-block;
  text-align: center;
}

#jar_dde9b5e8-wrapper #numpad {
  display: inline-block;
}

#jar_dde9b5e8-wrapper .key {
  background: #2a2a2a;
  border: 1px solid #444;
  border-radius: 6px;
  color: #fff;
  width: 40px;
  height: 40px;
  margin: 2px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.1s;
  vertical-align: top;
  display: inline-block;
}

#jar_dde9b5e8-wrapper .key:active {
  background: #444;
  transform: scale(0.95);
}

#jar_dde9b5e8-wrapper #choice { background: #4a5568; }
#jar_dde9b5e8-wrapper #back { background: #e53e3e; }
#jar_dde9b5e8-wrapper #ok { background: #38a169; }

/* Joypad layout fix */
#jar_dde9b5e8-wrapper .joypad-row {
  display: flex;
  justify-content: center;
  align-items: center;
}

#jar_dde9b5e8-wrapper .joypad-row.bottom {
  justify-content: center;
}

#jar_dde9b5e8-wrapper .numpad2 { display: none; }
#jar_dde9b5e8-wrapper.gamepad-2 .numpad { display: none; }
#jar_dde9b5e8-wrapper.gamepad-2 .numpad2 { display: inline-block; }

#jar_dde9b5e8-wrapper .lcdui-alert {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #fff;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  z-index: 1000;
  min-width: 280px;
  color: #333;
}

#jar_dde9b5e8-wrapper #header {
  display: none !important;
}

#jar_dde9b5e8-wrapper .loading-message {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #fff;
  font-size: 14px;
  z-index: 100;
  background: rgba(0,0,0,0.8);
  padding: 10px 20px;
  border-radius: 8px;
}

@media (max-width: 640px) {
  #jar_dde9b5e8-wrapper {
    margin: 10px;
    padding: 15px;
  }
  
  #jar_dde9b5e8-wrapper #canvas {
    max-width: calc(100vw - 60px);
    height: auto;
  }
  
  #jar_dde9b5e8-wrapper .key {
    width: 36px;
    height: 36px;
    font-size: 12px;
  }
  
  #jar_dde9b5e8-wrapper .player-tip {
    font-size: 12px;
    padding: 5px 10px;
  }
}
</code></pre>
<p></style></p>
  <div class="player-header">
    <div class="player-header-top">
      <div class="player-title">üì± ForgottenWarrior.jar</div>
      <div class="player-controls">
        <button class="ctrl-btn" id="jar_16d45272-status-btn">‚è≥ Loading...</button>
        <!--<button class="ctrl-btn" onclick="document.getElementById('display-container').requestFullscreen?.()">‚õ∂</button>-->
        <button class="ctrl-btn" onclick="location.reload()">‚Üª</button>
        <a href="0103/attachments/A8F4C5CC.dat" download class="ctrl-btn">‚¨á</a>
      </div>
    </div>
    <div class="player-tip">
      <span class="tip-icon">üí°</span>
      <span>ÊèêÁ§∫ÔºöÂ¶ÇÊûúÁ¨¨‰∏ÄÊ¨°Âä†ËΩΩÂá∫Áé∞Âç°È°øÔºåËØ∑Âà∑Êñ∞È°µÈù¢Âç≥ÂèØËß£ÂÜ≥</span>
    </div>
  </div>
  <!-- Hidden file input required by J2ME.js -->
  <input id="File" type="file" style="visibility:hidden;position:absolute;width:0;height:0">
  <!-- Main display matching J2ME.js structure -->
  <div id="display-container">
    <div id="display">
      <div id="header"></div>
      <canvas id="canvas" width="240" height="320"></canvas>
      <div id="download-screen" class="screen">
        <h1 class="title">Downloading midlet‚Ä¶</h1>
        <progress id="download-bar" value="0" max="100"></progress>
      </div>
      <div id="splash-screen" class="screen">
        <h1 class="title">Starting midlet‚Ä¶</h1>
        <progress></progress>
      </div>
      <div id="exit-screen" class="screen"></div>
      <div id="background-screen"></div>
      <div class="loading-message" id="jar_16d45272-loading-msg">Initializing...</div>
    </div>
  </div>
  <!-- LCDUI Alert Dialog -->
  <form role="dialog" data-type="confirm" class="lcdui-alert" id="lcdui-alert" style="display:none">
    <section>
      <h1 class="title"></h1>
      <p class="text"></p>
      <p><progress style="display:none"></progress></p>
    </section>
    <menu>
      <button class="button0" style="display:none"></button>
      <button class="button1" style="display:none"></button>
    </menu>
  </form>
  <!-- Virtual Keypad -->
  <div id="keypad" class="gamepad-3 row-reverse">
    <div id="joypad">
      <button id="choice" class="key">left</button>
      <button id="up" class="key">‚Üë</button>
      <button id="back" class="key">back</button><br>
      <button id="left" class="key">‚Üê</button>
      <button id="ok" class="key">OK</button>
      <button id="right" class="key">‚Üí</button><br>
       <span style="width:44px;display:inline-block;"></span>
	  <button id="down" class="key">‚Üì</button>
	  <span style="width:44px;display:inline-block;"></span>
    </div>
    <div id="numpad">
      <button id="num1" class="key">1</button>
      <button id="num2" class="key">2</button>
      <button id="num3" class="key">3</button>
      <button id="star" class="key numpad2">*</button><br>
      <button id="num4" class="key">4</button>
      <button id="num5" class="key">5</button>
      <button id="num6" class="key">6</button>
      <button id="num0" class="key numpad2">0</button><br>
      <button id="num7" class="key">7</button>
      <button id="num8" class="key">8</button>
      <button id="num9" class="key">9</button>
      <button id="pound" class="key numpad2">#</button><br>
      <button id="star" class="key numpad">*</button>
      <button id="num0" class="key numpad">0</button>
      <button id="pound" class="key numpad">#</button>
    </div>
  </div>
  <script>
  // Pre-setup configuration before any J2ME.js scripts load
  (function() {
	const JAR_NAME = 'ForgottenWarrior.jar';
    // Setup config object early
    v_config = {};
    v_config.localjar = JAR_NAME;
    v_config.enginemode = 'enginemode2-classes2.jar';
    v_config.gamepadSize = 'gamepad-3';
    v_config.gamepad = 1;
    v_config.canvasSize = 'size-240x320';
    v_config.gameresize = 'resize-1';
    //v_config.platform = 'Nokia503/14.0.4/java_runtime_version=Nokia_Asha_1_2';
    //v_config.autosize = false;
    console.log('Pre-configured v_config:', v_config);
  })();
  </script>
  <!-- Load J2ME.js dependencies first -->
  <script src="/jar_em/libs/encoding.js"></script>
  <script src="/jar_em/libs/webaudio-tinysynth.min.js"></script>
  <script src="/jar_em/libs/BenzAMRRecorder.min.js"></script>
  <!-- J2ME.js core files -->
  <script src="/jar_em/bld/native.js" defer></script>
  <script src="/jar_em/config/default.js" defer></script>
  <script src="/jar_em/config/build.js" defer></script>
  <script src="/jar_em/config/urlparams.js" defer></script>
  <script src="/jar_em/bld/j2me.js" defer></script>
  <script src="/jar_em/bld/main-all.js" defer></script>
  <script src="/jar_em/keymap.js" defer></script>
  <script>
  // Main initialization after scripts load
  (function() {
    const JAR_URL = '0103/attachments/A8F4C5CC.dat';
    const JAR_NAME = 'ForgottenWarrior.jar';
    const UNIQUE_ID = 'jar_16d45272';
    // Status update function
    function updateStatus(message, isSuccess) {
      const statusBtn = document.getElementById(UNIQUE_ID + '-status-btn');
      if (statusBtn) {
        statusBtn.textContent = message;
        if (isSuccess) {
          statusBtn.classList.add('success');
        }
      }
    }
    // Function to download and install JAR using JARStore
    async function downloadAndInstallJAR() {
      const loadingMsg = document.getElementById(UNIQUE_ID + '-loading-msg');
      try {
        updateStatus('‚è≥ Downloading...', false);
        if (loadingMsg) loadingMsg.textContent = 'Downloading JAR file...';
        console.log('Downloading JAR from:', JAR_URL);
        const response = await fetch(JAR_URL);
        if (!response.ok) {
          throw new Error('Failed to download JAR: ' + response.status);
        }
        const arrayBuffer = await response.arrayBuffer();
        console.log('JAR downloaded, size:', arrayBuffer.byteLength);
        updateStatus('‚è≥ Installing...', false);
        if (loadingMsg) loadingMsg.textContent = 'Installing JAR file...';
        // Wait for JARStore to be available and install
        return new Promise((resolve, reject) => {
          let attempts = 0;
          const maxAttempts = 100; // 10 seconds
          const checkAndInstall = setInterval(() => {
            attempts++;
            if (typeof JARStore !== 'undefined' && JARStore.installJAR) {
              clearInterval(checkAndInstall);
              // Install JAR using JARStore
              JARStore.installJAR(JAR_NAME, arrayBuffer).then(
                function() {
                  console.log('JAR installed successfully:', JAR_NAME);
                  updateStatus('‚úÖ Installed', true);
                  if (loadingMsg) loadingMsg.textContent = 'JAR installed, starting...';
                  resolve();
                },
                function(error) {
                  console.error('Failed to install JAR:', error);
                  reject(new Error('JAR installation failed: ' + error));
                }
              );
            } else if (attempts >= maxAttempts) {
              clearInterval(checkAndInstall);
              reject(new Error('JARStore not available (timeout)'));
            }
          }, 100);
        });
      } catch (error) {
        console.error('Failed to download/install JAR:', error);
        updateStatus('‚ùå Error', false);
        if (loadingMsg) {
          loadingMsg.textContent = 'Error: ' + error.message;
          loadingMsg.style.color = '#ff4444';
        }
        throw error;
      }
    }
    // Auto start the game after JAR is ready
    async function autoStart() {
      const loadingMsg = document.getElementById(UNIQUE_ID + '-loading-msg');
      try {
        // Wait for main function to be ready
        await new Promise(resolve => {
          let checkCount = 0;
          const checkMain = setInterval(() => {
            checkCount++;
            // main function is defined in main-all.js
            if (typeof main === 'function') {
              clearInterval(checkMain);
              resolve();
            } else if (checkCount > 50) { // 5 seconds timeout
              clearInterval(checkMain);
              resolve(); // Continue anyway
            }
          }, 100);
        });
        // Call start() to start the game
        if (typeof start === 'function') {
          console.log('Calling start() with config:', v_config);
          updateStatus('üéÆ Running', true);
          if (loadingMsg) loadingMsg.style.display = 'none';
          // Call main directly - it will use config
          console.log('call main-all.js start :', config);
          start();
        } else {
          throw new Error('start() function not found');
        }
      } catch (error) {
        console.error('Failed to start game:', error);
        updateStatus('‚ùå Start failed', false);
        if (loadingMsg) {
          loadingMsg.textContent = 'Failed to start: ' + error.message;
          loadingMsg.style.color = '#ff4444';
        }
      }
    }
    // Main initialization function
    async function initialize() {
      try {
        console.log('Starting J2ME initialization...');
        console.log('Config at init:', v_config);
        // Step 1: Download and install JAR
        await downloadAndInstallJAR();
        // Step 2: Wait a bit to ensure everything is ready
        await new Promise(resolve => setTimeout(resolve, 1000));
        // Step 3: Auto start the game
        await autoStart();
      } catch (error) {
        console.error('Initialization failed:', error);
        const loadingMsg = document.getElementById(UNIQUE_ID + '-loading-msg');
        if (loadingMsg) {
          loadingMsg.innerHTML = 'Failed to load game<br><button onclick="location.reload()" style="margin-top:10px;padding:5px 10px;">Retry</button>';
          loadingMsg.style.color = '#ff4444';
        }
      }
    }
    // Start when page is fully loaded
    window.addEventListener('load', function() {
      console.log('Page loaded, config:', v_config);
      console.log('Starting J2ME initialization...');
      // Give time for all deferred scripts to initialize
      setTimeout(initialize, 3000);
    });
  })();
  </script>
</div>  
    </article>
</div>

<footer>
    <div class="footer center text_center">
        <p><font size="2">Website is best viewed in 800x600 or higher equivalent resolution.</font></p>
        <hr>
        <p><img src="/CC-BY-SA.png" height="31">&nbsp;<img src="/linuxnow.gif">&nbsp;<img src="/anybrowser.gif"></p>
        <p><font size="2">Copyright ¬© 2015-2025 Jianxin Zhang. All rights reserved.<br>
            Unless otherwise noted, content on this site is licensed under CC BY-SA 4.0.</font></p>
    </div>
</footer>
</body>
</html>