<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mavne jar包去重以及升级,[来自项目中的经历]</title>
<meta name="description" content="回顾">
<meta name="keywords" content="Mavne, java">
<style>
body {
  background-color: #181818; /* Unix风格背景色 */
  font-family: sans-serif;
  color: #eee;
  margin: 0;
  padding: 0;
  max-width: 820px;
  margin: 0 auto;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

h1, h2, h3, h4, h5, h6 {
  text-align: center;
}

h1 {
  font-size: 20px;
}

h2 {
  font-size: 18px;
}

h3 {
  font-size: 16px;
}

h4 {
  font-size: 14px;
}

h5 {
  font-size: 12px;
}

h6 {
  font-size: 11px;
}

pre {
  background-color: #282c34;
  padding: 10px;
  border-radius: 4px;
  font-size: 14px;
  overflow-x: auto; /* 确保代码可以水平滚动 */
}

code {
  background-color: #333;
  color: #eee;
  padding: 2px 4px;
  border-radius: 4px;
  font-family: monospace;
}

img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 10px auto;
}

footer {
  text-align: center;
  padding: 10px;
  background-color: #222;
}

.highlight {
  background-color: #494949;
  color: #eee;
}

.highlight pre {
  background-color: #494949; /* 和高亮背景一致 */
  padding: 10px;
  border-radius: 4px;
  font-size: 14px;
  overflow-x: auto; /* 确保代码可以水平滚动 */
}
</style>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var codeElements = document.querySelectorAll('pre code');
    codeElements.forEach(function(code) {
      code.classList.add('highlight');
    });
  });
</script>
</head>
<body>
<h1>Mavne jar包去重以及升级,[来自项目中的经历]</h1>
<p>发这个贴的原因，是因为 是因为 是因为啥来着，忘了 那就是因为你，因为你 。</p>
<h2>错误描述</h2>
<pre><code class="highlight">  因为项目中用到ActorDB所以有了以下的故事，当maven中引入多个jar包，那么避免不了会发生重复的包存在。
 
</code></pre>
<ul>
<li>如图所示，成功的倒入了·`org.apache.thrift`
  但是工具里面没有找到 `clearBit`，`setBit`等方法。</li>
</ul>
<img src="http://112firshme11224.test.upcdn.net/blog/QQ20170708-002142@2x.png" alt="图片描述">
<ul>
<li>经过查证，的确没有，那么为什么会发生这个事情。</li>
</ul>
<img src="http://112firshme11224.test.upcdn.net/blog/error.png" alt="图片描述">
<ul>
<li>揭开迷雾</li>
</ul>
<img src="http://112firshme11224.test.upcdn.net/blog/success-geterror.png" alt="图片描述">
<ul>
<li>发现了存在的包竟然是MSF4J的包。
  于是找到了解决方案代码如下：
  
  <pre><code class="highlight">
   <dependency>
      <groupId>org.wso2.msf4j</groupId>
      <artifactId>msf4j-all</artifactId>
      <version>2.1.0</version>
      <exclusions>
          <exclusion>
              <artifactId>libthrift</artifactId>
              <groupId>org.apache.thrift</groupId>
          </exclusion>
      </exclusions>
  </dependency>
  </code></pre>
  
 * 通过这种方式进行包的摘除，(结果还不是很理想，还是有问题。)
   * 于是仔细查看pom.xml文件的内容，发现了问题，怀疑Maven加载包的顺序是有优先级的(从上到下)
   * 于是将 `org.apache.thrift` 放到了MSF4J包的上面。
   * 成功解决问题：
   <img src="http://112firshme11224.test.upcdn.net/blog/th3.png" alt="图片描述">
   
</li>
</ul>
<h2>总结</h2>
   学习了Mavne的加载顺序，以及排错方式：
<pre><code class="highlight">#查找依赖所在的地方
 mvn dependency:tree -Dverbose -Dincludes=org.apache.thrift:libthrift
</code></pre>
<pre><code class="highlight"><!--去除依赖，在外部加载-->
<exclusions>
      <exclusion>
          <artifactId>libthrift</artifactId>
          <groupId>org.apache.thrift</groupId>
      </exclusion>
  </exclusions>
</code></pre>
<footer>
<p>Power By Gemini TextGenerate 2024-09-16 21:52:24</p>
</footer>
</body>
</html>