<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>使用python把图片存入数据库.</title>
    <meta name="description" content="笔记">
    <meta name="keywords" content="Python,lambda">
    <style>
        body {
            background-color: #000000; /* Dos复古风格 */
            color: #ffffff;
            font-family: sans-serif;
            max-width: 820px;
            margin: 0 auto;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        h1 {
            font-size: 20px;
            margin-top: 0;
        }

        h2 {
            font-size: 18px;
        }

        h3 {
            font-size: 16px;
        }

        h4 {
            font-size: 14px;
        }

        h5 {
            font-size: 12px;
        }

        h6 {
            font-size: 11px;
        }

        pre {
            background-color: #222;
            padding: 10px;
            overflow-x: auto;
            border-radius: 5px;
        }

        code {
            color: #fff;
            font-family: monospace;
        }

        .highlight {
            background-color: #282c34; /* 代码高亮背景色 */
            color: #fff;
            padding: 5px;
        }

        footer {
            text-align: center;
            font-size: 12px;
            margin-top: 20px;
        }

        .title {
            text-align: center;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/highlightjs@11.7.0/lib/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>
        // 获取当前时间
        var now = new Date();
        var hour = now.getHours();
        // 判断当前时间是否为夜间模式
        if (hour >= 18 || hour < 6) {
            document.body.style.backgroundColor = '#111111'; // 夜间模式背景色
            document.body.style.color = '#ffffff'; // 夜间模式字体颜色
        } else {
            document.body.style.backgroundColor = '#f0f0f0'; // 白天模式背景色
            document.body.style.color = '#333333'; // 白天模式字体颜色
        }
    </script>
</head>
<body>
    <div class="title">
        <h1>使用python把图片存入数据库.</h1>
    </div>
    <p>没事看看文章而已～</p>

    <h2>使用python把图片存入数据库</h2>

    <p>一般情况下我们是把图片存储在文件系统中，而只在数据库中存储文件路径的，但是有时候也会有特殊的需求：把图片二进制存入数据库。</p>

    <p>今天我们采用的是python+mysql的方式</p>

    <p>MYSQL 是支持把图片存入数据库的，也相应的有一个专门的字段 BLOB (Binary Large Object)，即较大的二进制对象</p>

    <p>还有个更大的存二进制的LONGBLOB；</p>

    <p>这里需要注意：尽量把字段设置大一些，因为如果设置的字段长度过小，就会出现图片只显示一部分的情况。第二：如果数据量大的话尽量避免使用这种方式进行，因为mysql
    对于大数据的查询速度会很慢。</p>

    <h3>代码：</h3>

    <pre><code class="python">
#!/usr/bin/python
#-*- coding: UTF-8 -*-

import MySQLdb as mysql
import sys
try:
    #读取图片文件
    fp = open("./test.jpg")
    img = fp.read()
    fp.close()
except IOError,e:
    print "Error %d %s" % (e.args[0],e.args[1])
    sys.exit(1)
try:
    #mysql连接
    conn = mysql.connect(host='localhost',user='root',passwd='123456',db='test')
    cursor = conn.cursor()
    #注意使用Binary()函数来指定存储的是二进制
    cursor.execute("INSERT INTO images SET data='%s'" % mysql.Binary(img))
    #如果数据库没有设置自动提交，这里要提交一下
    conn.commit()
    cursor.close()
    #关闭数据库连接
    conn.close()
except mysql.Error,e:
    print "Error %d %s" % (e.args[0],e.args[1])
    sys.exit(1)

    </code></pre>

    <p>以上代码经过验证可以直接拿去修改调用</p>

    <p>Owner `breakEval13`</p>

    <p>https://github.com/breakEval13</p>

    <footer>
        Power By Gemini TextGenerate 2024-09-16 21:29:31
    </footer>
</body>
</html>