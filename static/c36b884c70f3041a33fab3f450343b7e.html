<!DOCTYPE html>
<html>
<head>
<style>
body {
  max-width: 820px;
  margin: 0 auto;
  padding: 20px;
  background-color: #f5f5f5;
  font-family: sans-serif;
  transition: background-color 0.5s ease;
}

h1 {
  font-size: 20px;
  margin-top: 0;
}

h2 {
  font-size: 18px;
}

h3 {
  font-size: 16px;
}

h4 {
  font-size: 14px;
}

h5 {
  font-size: 12px;
}

h6 {
  font-size: 11px;
}

pre {
  background-color: #f0f0f0;
  padding: 10px;
  border-radius: 5px;
  overflow-x: auto;
}

code {
  font-family: monospace;
}

.container {
  background-color: #fff;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  padding: 20px;
  border-radius: 5px;
}

.title {
  text-align: center;
  margin-bottom: 20px;
}

.description {
  text-align: center;
  margin-bottom: 20px;
}

.keywords {
  text-align: center;
  margin-bottom: 20px;
}

.footer {
  text-align: center;
  margin-top: 20px;
}

.dark-mode {
  background-color: #222;
  color: #fff;
}

.dark-mode pre {
  background-color: #333;
}

.dark-mode code {
  color: #fff;
}
</style>
<meta charset="UTF-8">
<title>Tdengine on k8s</title>
<meta name="description" content="将Tdengine 部署在k8s集群上,TDengine 集群模式">
<meta name="keywords" content="tdengine kuubernetes">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
<script>hljs.highlightAll();</script>
<script>
function toggleTheme() {
  var body = document.body;
  body.classList.toggle('dark-mode');
}

var currentHour = new Date().getHours();
if (currentHour >= 19 || currentHour < 6) {
  toggleTheme();
}
</script>
</head>
<body>
<div class="container">
<div class="title">
<h1>Tdengine on k8s</h1>
</div>
<div class="description">
<p>将Tdengine 部署在k8s集群上,TDengine 集群模式</p>
</div>
<div class="keywords">
<p>tdengine kuubernetes</p>
</div>
<p>将 Tdengine 集群模式部署到 Kubernetes ，支持扩节点，后面我会将自动脚本提交到 我的github。</p>
<h2>准备</h2>
<ul>
<li>Tdengine 2.0.20 源代码</li>
<li>K8S集群(存储 nfs ceph)</li>
<li>yaml 文件</li>
</ul>
<h2>为集群创建 存储（使用nfs）</h2>
<pre><code class="yaml">

# 这里面提前创建好了  storage = nfs
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: testtdpvc1
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: "20"
  volumeName:
  storageClassName: nfs
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: testtdpvc2
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: "20"
  volumeName:
  storageClassName: nfs
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: testtdpvc3
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: "20"
  volumeName:
  storageClassName: nfs


</code></pre>
<h2>准备集群配置文件</h2>
<pre><code class="yaml">

apiVersion: v1
kind: ConfigMap
metadata:
  name: tdmnode
  labels:
    app: tdmnode
data:
  ms1.cnf: |
    ########################################################
    #                                                      #
    #                  TDengine Configuration              #
    #   Any questions, please email support@taosdata.com   #
    #                                                      #
    ########################################################

    # first fully qualified domain name (FQDN) for TDengine system
    firstEp                   tdmnode-0.default.svc.cluster.local:6030
    secondEp                  tdmnode-1.default.svc.cluster.local:6030
    # local fully qualified domain name (FQDN)
    fqdn                      tdmnode-0.default.svc.cluster.local

    # first port number for the connection (12 continuous UDP/TCP port number are used)
    serverPort                6030

    # log file's director
    logDir                    /etc/taos/log

    # data file's directory
    dataDir                   /etc/taos/data

    # temporary file's directory
    tempDir                   /tmp/

    # the arbitrator's fully qualified domain name (FQDN) for TDengine system, for cluster only
    # arbitrator                arbitrator_hostname:6042

    # number of threads per CPU core
    # numOfThreadsPerCore       1.0

    # number of threads to commit cache data
    numOfCommitThreads        4

    # the proportion of total CPU cores available for query processing
    # 2.0: the query threads will be set to double of the CPU cores.
    # 1.0: all CPU cores are available for query processing [default].
    # 0.5: only half of the CPU cores are available for query.
    # 0.0: only one core available.
    # ratioOfQueryCores        1.0

    # the last_row/first/last aggregator will not change the original column name in the result fields
    # keepColumnName            0

    # number of management nodes in the system
    # numOfMnodes               3

    # enable/disable backuping vnode directory when removing vnode
    # vnodeBak                  1

    # enable/disable installation / usage report
    # telemetryReporting        1

    # enable/disable load balancing
    # balance                   1

    # role for dnode. 0 - any, 1 - mnode, 2 - dnode
    # role                      0

    # max timer control blocks
    # maxTmrCtrl                512

    # time interval of system monitor, seconds
    # monitorInterval           30

    # number of seconds allowed for a dnode to be offline, for cluster only
    # offlineThreshold          8640000

    # RPC re-try timer, millisecond
    # rpcTimer                  300

    # RPC maximum time for ack, seconds.
    # rpcMaxTime                600

    # time interval of dnode status reporting to mnode, seconds, for cluster only
    # statusInterval            1

    # time interval of heart beat from shell to dnode, seconds
    # shellActivityTimer        3

    # minimum sliding window time, milli-second
    # minSlidingTime            10

    # minimum time window, milli-second
    # minIntervalTime           10

    # maximum delay before launching a stream computation, milli-second
    # maxStreamCompDelay        20000

    # maximum delay before launching a stream computation for the first time, milli-second
    # maxFirstStreamCompDelay   10000

    # retry delay when a stream computation fails, milli-second
    # retryStreamCompDelay      10

    # the delayed time for launching a stream computation, from 0.1(default, 10% of whole computing time window) to 0.9
    # streamCompDelayRatio      0.1

    # max number of vgroups per db, 0 means configured automatically
    # maxVgroupsPerDb           0

    # max number of tables per vnode
    # maxTablesPerVnode         1000000

    # cache block size (Mbyte)
    # cache                     16

    # number of cache blocks per vnode
    # blocks                    6

    # number of days per DB file
    days                  3650

    # number of days to keep DB file
    # keep                  3650

    # minimum rows of records in file block
    # minRows               100

    # maximum rows of records in file block
    # maxRows               4096

    # the number of acknowledgments required for successful data writing
    # quorum                1

    # enable/disable compression
    # comp                  2

    # write ahead log (WAL) level, 0: no wal; 1: write wal, but no fysnc; 2: write wal, and call fsync
    # walLevel              1

    # if walLevel is set to 2, the cycle of fsync being executed, if set to 0, fsync is called right away
    # fsync                 3000

    # number of replications, for cluster only
    # replica               1

    # the compressed rpc message, option:
    #  -1 (no compression)
    #   0 (all message compressed),
    # > 0 (rpc message body which larger than this value will be compressed)
    # compressMsgSize       -1

    # max length of an SQL
    # maxSQLLength          65480

    # the maximum number of records allowed for super table time sorting
    # maxNumOfOrderedRes    100000

    # system time zone
    # timezone              Asia/Shanghai (CST, +0800)

    # system locale
    # locale                en_US.UTF-8

    # default system charset
    # charset               UTF-8

    # max number of connections allowed in dnode
    # maxShellConns         5000

    # max number of connections allowed in client
    # maxConnections        5000

    # stop writing logs when the disk size of the log folder is less than this value
    # minimalLogDirGB       0.1

    # stop writing temporary files when the disk size of the tmp folder is less than this value
    # minimalTmpDirGB       0.1

    # if disk free space is less than this value, taosd service exit directly within startup process
    # minimalDataDirGB      0.1

    # One mnode is equal to the number of vnode consumed
    # mnodeEqualVnodeNum    4

    # enbale/disable http service
    # http                  1

    # enable/disable system monitor
    # monitor               1

    # enable/disable recording the SQL statements via restful interface
    # httpEnableRecordSql   0

    # number of threads used to process http requests
    # httpMaxThreads        2

    # maximum number of rows returned by the restful interface
    # restfulRowLimit       10240

    # The following parameter is used to limit the maximum number of lines in log files.
    # max number of lines per log filters
    # numOfLogLines         10000000

    # enable/disable async log
    # asyncLog              1

    # time of keeping log files, days
    # logKeepDays           0


    # The following parameters are used for debug purpose only.
    # debugFlag 8 bits mask: FILE-SCREEN-UNUSED-HeartBeat-DUMP-TRACE_WARN-ERROR
    # 131: output warning and error
    # 135: output debug, warning and error
    # 143: output trace, debug, warning and error to log
    # 199: output debug, warning and error to both screen and file
    # 207: output trace, debug, warning and error to both screen and file

    # debug flag for all log type, take effect when non-zero value
    debugFlag             135

    # debug flag for meta management messages
    # mDebugFlag            135

    # debug flag for dnode messages
    # dDebugFlag            135

    # debug flag for sync module
    # sDebugFlag            135

    # debug flag for WAL
    # wDebugFlag            135

    # debug flag for SDB
    # sdbDebugFlag          135

    # debug flag for RPC
    # rpcDebugFlag          131

    # debug flag for TAOS TIMER
    # tmrDebugFlag          131

    # debug flag for TDengine client
    # cDebugFlag            131

    # debug flag for JNI
    # jniDebugFlag          131

    # debug flag for storage
    # uDebugFlag            131

    # debug flag for http server
    # httpDebugFlag         131

    # debug flag for monitor
    # monDebugFlag          131

    # debug flag for query
    # qDebugFlag            131

    # debug flag for vnode
    # vDebugFlag            131

    # debug flag for TSDB
    # tsdbDebugFlag         131

    # debug flag for continue query
    # cqDebugFlag           131

    # enable/disable recording the SQL in taos client
    # enableRecordSql    0

    # generate core file when service crash
    # enableCoreFile        1

    # maximum display width of binary and nchar fields in the shell. The parts exceeding this limit will be hidden
    # maxBinaryDisplayWidth 30

    # enable/disable stream (continuous query)
    # stream                1

    # in retrieve blocking model, only in 50% query threads will be used in query processing in dnode
    # retrieveBlockingModel    0

    # the maximum allowed query buffer size in MB during query processing for each data node
    # -1 no limit (default)
    # 0  no query allowed, queries are disabled
    # queryBufferSize         -1
  ms2.cnf: |
    ########################################################
    #                                                      #
    #                  TDengine Configuration              #
    #   Any questions, please email support@taosdata.com   #
    #                                                      #
    ########################################################

    # first fully qualified domain name (FQDN) for TDengine system
    firstEp                   tdmnode-0.default.svc.cluster.local:6030
    secondEp                  tdmnode-1.default.svc.cluster.local:6030
    # local fully qualified domain name (FQDN)
    fqdn                      tdmnode-1.default.svc.cluster.local

    # first port number for the connection (12 continuous UDP/TCP port number are used)
    serverPort                6030

    # log file's director
    logDir                    /etc/taos/log

    # data file's directory
    dataDir                   /etc/taos/data

    # temporary file's directory
    tempDir                   /tmp/

    # the arbitrator's fully qualified domain name (FQDN) for TDengine system, for cluster only
    # arbitrator                arbitrator_hostname:6042

    # number of threads per CPU core
    # numOfThreadsPerCore       1.0

    # number of threads to commit cache data
    numOfCommitThreads        4

    # the proportion of total CPU cores available for query processing
    # 2.0: the query threads will be set to double of the CPU cores.
    # 1.0: all CPU cores are available for query processing [default].
    # 0.5: only half of the CPU cores are available for query.
    # 0.0: only one core available.
    # ratioOfQueryCores        1.0

    # the last_row/first/last aggregator will not change the original column name in the result fields
    # keepColumnName            0

    # number of management nodes in the system
    # numOfMnodes               3

    # enable/disable backuping vnode directory when removing vnode
    # vnodeBak                  1

    # enable/disable installation / usage report
    # telemetryReporting        1

    # enable/disable load balancing
    # balance                   1

    # role for dnode. 0 - any, 1 - mnode, 2 - dnode
    # role                      0

    # max timer control blocks
    # maxTmrCtrl                512

    # time interval of system monitor, seconds
    # monitorInterval           30

    # number of seconds allowed for a dnode to be offline, for cluster only
    # offlineThreshold          8640000

    # RPC re-try timer, millisecond
    # rpcTimer                  300

    # RPC maximum time for ack, seconds.
    # rpcMaxTime                600

    # time interval of dnode status reporting to mnode, seconds, for cluster only
    # statusInterval            1

    # time interval of heart beat from shell to dnode, seconds
    # shellActivityTimer        3

    # minimum sliding window time, milli-second
    # minSlidingTime            10

    # minimum time window, milli-second
    # minIntervalTime           10

    # maximum delay before launching a stream computation, milli-second
    # maxStreamCompDelay        20000

    # maximum delay before launching a stream computation for the first time, milli-second
    # maxFirstStreamCompDelay   10000

    # retry delay when a stream computation fails, milli-second
    # retryStreamCompDelay      10

    # the delayed time for launching a stream computation, from 0.1(default, 10% of whole computing time window) to 0.9
    # streamCompDelayRatio      0.1

    # max number of vgroups per db, 0 means configured automatically
    # maxVgroupsPerDb           0

    # max number of tables per vnode
    # maxTablesPerVnode         1000000

    # cache block size (Mbyte)
    # cache                     16

    # number of cache blocks per vnode
    # blocks                    6

    # number of days per DB file
    days                  3650

    # number of days to keep DB file
    # keep                  3650

    # minimum rows of records in file block
    # minRows               100

    # maximum rows of records in file block
    # maxRows               4096

    # the number of acknowledgments required for successful data writing
    # quorum                1

    # enable/disable compression
    # comp                  2

    # write ahead log (WAL) level, 0: no wal; 1: write wal, but no fysnc; 2: write wal, and call fsync
    # walLevel              1

    # if walLevel is set to 2, the cycle of fsync being executed, if set to 0, fsync is called right away
    # fsync                 3000

    # number of replications, for cluster only
    # replica               1

    # the compressed rpc message, option:
    #  -1 (no compression)
    #   0 (all message compressed),
    # > 0 (rpc message body which larger than this value will be compressed)
    # compressMsgSize       -1

    # max length of an SQL
    # maxSQLLength          65480

    # the maximum number of records allowed for super table time sorting
    # maxNumOfOrderedRes    100000

    # system time zone
    # timezone              Asia/Shanghai (CST, +0800)

    # system locale
    # locale                en_US.UTF-8

    # default system charset
    # charset               UTF-8

    # max number of connections allowed in dnode
    # maxShellConns         5000

    # max number of connections allowed in client
    # maxConnections        5000

    # stop writing logs when the disk size of the log folder is less than this value
    # minimalLogDirGB       0.1

    # stop writing temporary files when the disk size of the tmp folder is less than this value
    # minimalTmpDirGB       0.1

    # if disk free space is less than this value, taosd service exit directly within startup process
    # minimalDataDirGB      0.1

    # One mnode is equal to the number of vnode consumed
    # mnodeEqualVnodeNum    4

    # enbale/disable http service
    # http                  1

    # enable/disable system monitor
    # monitor               1

    # enable/disable recording the SQL statements via restful interface
    # httpEnableRecordSql   0

    # number of threads used to process http requests
    # httpMaxThreads        2

    # maximum number of rows returned by the restful interface
    # restfulRowLimit       10240

    # The following parameter is used to limit the maximum number of lines in log files.
    # max number of lines per log filters
    # numOfLogLines         10000000

    # enable/disable async log
    # asyncLog              1

    # time of keeping log files, days
    # logKeepDays           0


    # The following parameters are used for debug purpose only.
    # debugFlag 8 bits mask: FILE-SCREEN-UNUSED-HeartBeat-DUMP-TRACE_WARN-ERROR
    # 131: output warning and error
    # 135: output debug, warning and error
    # 143: output trace, debug, warning and error to log
    # 199: output debug, warning and error to both screen and file
    # 207: output trace, debug, warning and error to both screen and file

    # debug flag for all log type, take effect when non-zero value
    debugFlag             135

    # debug flag for meta management messages
    # mDebugFlag            135

    # debug flag for dnode messages
    # dDebugFlag            135

    # debug flag for sync module
    # sDebugFlag            135

    # debug flag for WAL
    # wDebugFlag            135

    # debug flag for SDB
    # sdbDebugFlag          135

    # debug flag for RPC
    # rpcDebugFlag          131

    # debug flag for TAOS TIMER
    # tmrDebugFlag          131

    # debug flag for TDengine client
    # cDebugFlag            131

    # debug flag for JNI
    # jniDebugFlag          131

    # debug flag for storage
    # uDebugFlag            131

    # debug flag for http server
    # httpDebugFlag         131

    # debug flag for monitor
    # monDebugFlag          131

    # debug flag for query
    # qDebugFlag            131

    # debug flag for vnode
    # vDebugFlag            131

    # debug flag for TSDB
    # tsdbDebugFlag         131

    # debug flag for continue query
    # cqDebugFlag           131

    # enable/disable recording the SQL in taos client
    # enableRecordSql    0

    # generate core file when service crash
    # enableCoreFile        1

    # maximum display width of binary and nchar fields in the shell. The parts exceeding this limit will be hidden
    # maxBinaryDisplayWidth 30

    # enable/disable stream (continuous query)
    # stream                1

    # in retrieve blocking model, only in 50% query threads will be used in query processing in dnode
    # retrieveBlockingModel    0

    # the maximum allowed query buffer size in MB during query processing for each data node
    # -1 no limit (default)
    # 0  no query allowed, queries are disabled
    # queryBufferSize         -1
  ms3.cnf: |
    ########################################################
    #                                                      #
    #                  TDengine Configuration              #
    #   Any questions, please email support@taosdata.com   #
    #                                                      #
    ########################################################


    # first fully qualified domain name (FQDN) for TDengine system
    firstEp                   tdmnode-0.default.svc.cluster.local:6030
    secondEp                  tdmnode-1.default.svc.cluster.local:6030
    # local fully qualified domain name (FQDN)
    fqdn                      tdmnode-2.default.svc.cluster.local

    # first port number for the connection (12 continuous UDP/TCP port number are used)
    serverPort                6030


    # log file's director
    logDir                    /etc/taos/log

    # data file's directory
    dataDir                   /etc/taos/data

    # temporary file's directory
    tempDir                   /tmp/

    # the arbitrator's fully qualified domain name (FQDN) for TDengine system, for cluster only
    # arbitrator                arbitrator_hostname:6042

    # number of threads per CPU core
    # numOfThreadsPerCore       1.0

    # number of threads to commit cache data
    numOfCommitThreads        4

    # the proportion of total CPU cores available for query processing
    # 2.0: the query threads will be set to double of the CPU cores.
    # 1.0: all CPU cores are available for query processing [default].
    # 0.5: only half of the CPU cores are available for query.
    # 0.0: only one core available.
    # ratioOfQueryCores        1.0

    # the last_row/first/last aggregator will not change the original column name in the result fields
    # keepColumnName            0

    # number of management nodes in the system
    # numOfMnodes               3

    # enable/disable backuping vnode directory when removing vnode
    # vnodeBak                  1

    # enable/disable installation / usage report
    # telemetryReporting        1

    # enable/disable load balancing
    # balance                   1

    # role for dnode. 0 - any, 1 - mnode, 2 - dnode
    # role                      0

    # max timer control blocks
    # maxTmrCtrl                512

    # time interval of system monitor, seconds
    # monitorInterval           30

    # number of seconds allowed for a dnode to be offline, for cluster only
    # offlineThreshold          8640000

    # RPC re-try timer, millisecond
    # rpcTimer                  300

    # RPC maximum time for ack, seconds.
    # rpcMaxTime                600

    # time interval of dnode status reporting to mnode, seconds, for cluster only
    # statusInterval            1

    # time interval of heart beat from shell to dnode, seconds
    # shellActivityTimer        3

    # minimum sliding window time, milli-second
    # minSlidingTime            10

    # minimum time window, milli-second
    # minIntervalTime           10

    # maximum delay before launching a stream computation, milli-second
    # maxStreamCompDelay        20000

    # maximum delay before launching a stream computation for the first time, milli-second
    # maxFirstStreamCompDelay   10000

    # retry delay when a stream computation fails, milli-second
    # retryStreamCompDelay      10

    # the delayed time for launching a stream computation, from 0.1(default, 10% of whole computing time window) to 0.9
    # streamCompDelayRatio      0.1

    # max number of vgroups per db, 0 means configured automatically
    # maxVgroupsPerDb           0

    # max number of tables per vnode
    # maxTablesPerVnode         1000000

    # cache block size (Mbyte)
    # cache                     16

    # number of cache blocks per vnode
    # blocks                    6

    # number of days per DB file
    days                  3650

    # number of days to keep DB file
    # keep                  3650

    # minimum rows of records in file block
    # minRows               100

    # maximum rows of records in file block
    # maxRows               4096

    # the number of acknowledgments required for successful data writing
    # quorum                1

    # enable/disable compression
    # comp                  2

    # write ahead log (WAL) level, 0: no wal; 1: write wal, but no fysnc; 2: write wal, and call fsync
    # walLevel              1

    # if walLevel is set to 2, the cycle of fsync being executed, if set to 0, fsync is called right away
    # fsync                 3000

    # number of replications, for cluster only
    # replica               1

    # the compressed rpc message, option:
    #  -1 (no compression)
    #   0 (all message compressed),
    # > 0 (rpc message body which larger than this value will be compressed)
    # compressMsgSize       -1

    # max length of an SQL
    # maxSQLLength          65480

    # the maximum number of records allowed for super table time sorting
    # maxNumOfOrderedRes    100000

    # system time zone
    # timezone              Asia/Shanghai (CST, +0800)

    # system locale
    # locale                en_US.UTF-8

    # default system charset
    # charset               UTF-8

    # max number of connections allowed in dnode
    # maxShellConns         5000

    # max number of connections allowed in client
    # maxConnections        5000

    # stop writing logs when the disk size of the log folder is less than this value
    # minimalLogDirGB       0.1

    # stop writing temporary files when the disk size of the tmp folder is less than this value
    # minimalTmpDirGB       0.1

    # if disk free space is less than this value, taosd service exit directly within startup process
    # minimalDataDirGB      0.1

    # One mnode is equal to the number of vnode consumed
    # mnodeEqualVnodeNum    4

    # enbale/disable http service
    # http                  1

    # enable/disable system monitor
    # monitor               1

    # enable/disable recording the SQL statements via restful interface
    # httpEnableRecordSql   0

    # number of threads used to process http requests
    # httpMaxThreads        2

    # maximum number of rows returned by the restful interface
    # restfulRowLimit       10240

    # The following parameter is used to limit the maximum number of lines in log files.
    # max number of lines per log filters
    # numOfLogLines         10000000

    # enable/disable async log
    # asyncLog              1

    # time of keeping log files, days
    # logKeepDays           0


    # The following parameters are used for debug purpose only.
    # debugFlag 8 bits mask: FILE-SCREEN-UNUSED-HeartBeat-DUMP-TRACE_WARN-ERROR
    # 131: output warning and error
    # 135: output debug, warning and error
    # 143: output trace, debug, warning and error to log
    # 199: output debug, warning and error to both screen and file
    # 207: output trace, debug, warning and error to both screen and file

    # debug flag for all log type, take effect when non-zero value
    debugFlag             135

    # debug flag for meta management messages
    # mDebugFlag            135

    # debug flag for dnode messages
    # dDebugFlag            135

    # debug flag for sync module
    # sDebugFlag            135

    # debug flag for WAL
    # wDebugFlag            135

    # debug flag for SDB
    # sdbDebugFlag          135

    # debug flag for RPC
    # rpcDebugFlag          131

    # debug flag for TAOS TIMER
    # tmrDebugFlag          131

    # debug flag for TDengine client
    # cDebugFlag            131

    # debug flag for JNI
    # jniDebugFlag          131

    # debug flag for storage
    # uDebugFlag            131

    # debug flag for http server
    # httpDebugFlag         131

    # debug flag for monitor
    # monDebugFlag          131

    # debug flag for query
    # qDebugFlag            131

    # debug flag for vnode
    # vDebugFlag            131

    # debug flag for TSDB
    # tsdbDebugFlag         131

    # debug flag for continue query
    # cqDebugFlag           131

    # enable/disable recording the SQL in taos client
    # enableRecordSql    0

    # generate core file when service crash
    # enableCoreFile        1

    # maximum display width of binary and nchar fields in the shell. The parts exceeding this limit will be hidden
    # maxBinaryDisplayWidth 30

    # enable/disable stream (continuous query)
    # stream                1

    # in retrieve blocking model, only in 50% query threads will be used in query processing in dnode
    # retrieveBlockingModel    0

    # the maximum allowed query buffer size in MB during query processing for each data node
    # -1 no limit (default)
    # 0  no query allowed, queries are disabled
    # queryBufferSize         -1



</code></pre>
<h2>节点配置文件 1</h2>
<pre><code class="yaml">

apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: tdmnode-0
spec:
  selector:
    matchLabels:
      app: tdmnode-0
  serviceName: "tdmnode-0"
  replicas: 1
  template:
    metadata:
      labels:
        app: tdmnode-0
    spec:
      containers:
        - name: tdmnode-0
          image: tdengine/tdengine:latest
          ports:
            - containerPort: 6030
            - containerPort: 6035
            - containerPort: 6041
            - containerPort: 6031
            - containerPort: 6032
            - containerPort: 6033
            - containerPort: 6034
            - containerPort: 6036
            - containerPort: 6037
            - containerPort: 6038
            -