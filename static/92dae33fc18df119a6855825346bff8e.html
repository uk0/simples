<!DOCTYPE html>
<html>
<head>
<style>
body {
  max-width: 820px;
  margin: 0 auto;
  padding: 20px;
  font-family: sans-serif;
  background-color: #f0f0f0;
  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
  transition: background-color 0.3s ease;
}

h1 {
  font-size: 20px;
  margin-top: 0;
}

h2 {
  font-size: 18px;
}

h3 {
  font-size: 16px;
}

h4 {
  font-size: 14px;
}

h5 {
  font-size: 12px;
}

h6 {
  font-size: 11px;
}

pre {
  background-color: #f0f0f0;
  padding: 10px;
  border-radius: 5px;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

code {
  font-family: monospace;
  background-color: #eee;
  padding: 2px 4px;
  border-radius: 3px;
}

footer {
  text-align: center;
  margin-top: 20px;
  font-size: 12px;
}

.title-container {
  text-align: center;
}

.title-container h1 {
  margin-bottom: 10px;
}

.title-container p {
  font-size: 14px;
  color: #666;
}

.highlight {
  background-color: #f8f8f8;
  padding: 10px;
  border-radius: 5px;
}

.highlight pre {
  background-color: transparent;
  padding: 0;
  margin: 0;
}

.highlight code {
  background-color: transparent;
  padding: 0;
}
</style>
<meta charset="UTF-8">
<title>linux硬盘检查大小awk脚本全自动执行,以及日志抽取</title>
<meta name="description" content="硬盘监测">
<meta name="keywords" content="awk linux 硬盘检查">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
<script>
  hljs.highlightAll();
  const randomSeed = 199602051111;
  Math.seedrandom(randomSeed);
  const time = new Date();
  const isDaytime = time.getHours() >= 6 && time.getHours() < 18;
  document.body.style.backgroundColor = isDaytime ? '#f0f0f0' : '#222';
</script>
</head>
<body>
<div class="title-container">
<h1>linux硬盘检查大小awk脚本全自动执行,以及日志抽取</h1>
<p>硬盘监测</p>
</div>

<h2>DISK 监测剩余量</h2>

<pre><code class="bash">#!/bin/bash
temp=0.0
DISK_SIZE=0.0
for i in {0..26}
do
    echo -e "dscn0$i Disk"
    echo "剩余可用大小GB"
    temp=`ssh dscn0$i df -m|grep hadoop | awk '$4~/^[0-9]/ {split($4,array,"[A-Z]");b+=array[1]} END {print b/1024}'`
    DISK_SIZE=$(echo "$DISK_SIZE + $temp" | bc)

    echo -e "总数 剩余 占比 目录"
    ssh dscn0$i df -h | grep hadoop  | awk '{print$2, $4, $5, $6}'
done
echo -e "\033[32m 剩余总大小: $DISK_SIZE GB \033[0m"

</code></pre>

<h2>bash 样式</h2>

<pre><code class="bash">

    PS1='\[\e[1;32m\]\u@\h\[\e[m\]:\[\e[1;34m\]\W\[\e[1;33m\]\$\[\e[m\] '
    
</code></pre>

<h2> 抽取一天的日志到另一个日志文件</h2>

<pre><code class="bash">#!/bin/bash

TIME_LINE=$(date +%Y%m%d%H%M%S)


function getOne(){
    # 设定变量
    if [ -z $1 ];then
        echo -e "\033[31m Error: log Name is Null  \033[0m"
        echo -e "\033[32m Simple : ./readlogs.sh getOne xxx.log  \033[0m"
        exit 1
    fi
    log=$1
    s=`date -d yesterday +%F` #前一天
    #s=$(date +%F) #今天
    e=$(date +%F) #今天
    # 根据条件获得开始和结束的行号
    sl=`cat -n $log | grep $s | head -1 | sed 's/^[ \t]*//g' | cut -f 1`
    el=`cat -n $log | grep $e | tail -1 | sed 's/^[ \t]*//g' | cut -f 1`
    echo -e "\033[32m start Line $sl \033[0m"
    echo -e "\033[32m end Line $el \033[0m"
    # 获取结果并输出到 `date`.log 文件
    sed -n "$sl,$el"'p' $log >> check_auto_$TIME_LINE.log
}

case $1 in

"getOne")
	getOne $2
	;;
*)
	echo -e "\033[1m usage: \n \t  [getOne] \033[0m"
	echo -e "\033[1m DESC: \n \t getOne : 获得一天内的文件日志，并且进行导出。 \033[0m"
	exit 2 # Command to come out of the program with status 1
	;;
esac
exit 0

</code></pre>

<footer>
Power By Gemini TextGenerate 2024-09-16
</footer>
</body>
</html>