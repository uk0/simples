<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>linux硬盘检查大小awk脚本全自动执行,以及日志抽取</title>
<meta name="description" content="硬盘监测">
<meta name="keywords" content="awk linux 硬盘检查">
<style>
body {
    background-color: #000000;
    color: #ffffff;
    font-family: monospace;
    max-width: 820px;
    margin: 0 auto;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

h1, h2, h3, h4, h5, h6 {
    text-align: center;
    margin-bottom: 10px;
}

h1 {
    font-size: 20px;
}

h2 {
    font-size: 18px;
}

h3 {
    font-size: 16px;
}

h4 {
    font-size: 14px;
}

h5 {
    font-size: 12px;
}

h6 {
    font-size: 11px;
}

code {
    background-color: #222222;
    color: #00ff00;
    padding: 2px 4px;
    border-radius: 4px;
}

pre code {
    display: block;
    padding: 10px;
    overflow-x: auto;
    white-space: pre-wrap;
    word-wrap: break-word;
}

.hljs {
    background-color: #222222;
    color: #00ff00;
    padding: 10px;
    border-radius: 4px;
    overflow-x: auto;
}

.hljs-comment {
    color: #808080;
}

.hljs-keyword {
    color: #00ffff;
}

.hljs-string {
    color: #00ff00;
}

.hljs-number {
    color: #00ffff;
}

.hljs-variable {
    color: #ff00ff;
}

.hljs-function {
    color: #ff00ff;
}

.hljs-title {
    color: #ff00ff;
}

footer {
    text-align: center;
    margin-top: 20px;
}
</style>
</head>
<body>
<h1>linux硬盘检查大小awk脚本全自动执行,以及日志抽取</h1>
<h2 id="disk-监测剩余量">DISK 监测剩余量</h2>
<pre><code class="hljs bash">#!/bin/bash
temp=0.0
DISK_SIZE=0.0
for i in {0..26}
do
    echo -e "dscn0$i Disk"
    echo "剩余可用大小GB"
    temp=`ssh dscn0$i df -m|grep hadoop | awk '$4~/^[0-9]/ {split($4,array,"[A-Z]");b+=array[1]} END {print b/1024}'`
    DISK_SIZE=$(echo "$DISK_SIZE + $temp" | bc)

    echo -e "总数 剩余 占比 目录"
    ssh dscn0$i df -h | grep hadoop  | awk '{print$2, $4, $5, $6}'
done
echo -e "\033[32m 剩余总大小: $DISK_SIZE GB \033[0m"

</code></pre>
<h2 id="bash-样式">bash 样式</h2>
<pre><code class="hljs bash">

    PS1='\[\e[1;32m\]\u@\h\[\e[m\]:\[\e[1;34m\]\W\[\e[1;33m\]\$\[\e[m\] '
    
</code></pre>
<h2 id="抽取一天的日志到另一个日志文件"> 抽取一天的日志到另一个日志文件</h2>
<pre><code class="hljs bash">#!/bin/bash

TIME_LINE=$(date +%Y%m%d%H%M%S)


function getOne(){
    # 设定变量
    if [ -z $1 ];then
        echo -e "\033[31m Error: log Name is Null  \033[0m"
        echo -e "\033[32m Simple : ./readlogs.sh getOne xxx.log  \033[0m"
        exit 1
    fi
    log=$1
    s=`date -d yesterday +%F` #前一天
    #s=$(date +%F) #今天
    e=$(date +%F) #今天
    # 根据条件获得开始和结束的行号
    sl=`cat -n $log | grep $s | head -1 | sed 's/^[ \t]*//g' | cut -f 1`
    el=`cat -n $log | grep $e | tail -1 | sed 's/^[ \t]*//g' | cut -f 1`
    echo -e "\033[32m start Line $sl \033[0m"
    echo -e "\033[32m end Line $el \033[0m"
    # 获取结果并输出到 `date`.log 文件
    sed -n "$sl,$el"'p' $log >> check_auto_$TIME_LINE.log
}

case $1 in

"getOne")
	getOne $2
	;;
*)
	echo -e "\033[1m usage: \n \t  [getOne] \033[0m"
	echo -e "\033[1m DESC: \n \t getOne : 获得一天内的文件日志，并且进行导出。 \033[0m"
	exit 2 # Command to come out of the program with status 1
	;;
esac
exit 0

</code></pre>
<p>转载请注明出处，本文采用 <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">CC4.0</a> 协议授权</p>
<footer>
<p>Power By Gemini TextGenerate 2024-09-16 21:51:32</p>
</footer>
<script>
// Initialize hljs
hljs.highlightAll();

// Set background color based on time
const now = new Date();
const hour = now.getHours();

if (hour >= 6 && hour < 18) {
    document.body.style.backgroundColor = "#f5f5f5"; // Daytime mode
} else {
    document.body.style.backgroundColor = "#222222"; // Nighttime mode
}
</script>
</body>
</html>