<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>基于Python DeJavu 进音乐指纹识别，识别歌曲</title>
<meta name="description" content="识别音乐">
<meta name="keywords" content="">
<style>
body {
  font-family: sans-serif;
  background-color: #f5f5f5;
  color: #333;
  max-width: 820px;
  margin: 0 auto;
  padding: 20px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

h1 {
  font-size: 20px;
  margin-bottom: 10px;
}

h2 {
  font-size: 18px;
  margin-bottom: 8px;
}

h3 {
  font-size: 16px;
  margin-bottom: 6px;
}

h4 {
  font-size: 14px;
  margin-bottom: 4px;
}

h5 {
  font-size: 12px;
  margin-bottom: 2px;
}

h6 {
  font-size: 11px;
  margin-bottom: 1px;
}

pre {
  background-color: #f5f5f5;
  padding: 10px;
  border: 1px solid #ddd;
  overflow-x: auto;
}

code {
  font-family: monospace;
  background-color: #eee;
  padding: 2px 4px;
  border-radius: 3px;
}

img {
  max-width: 100%;
  height: auto;
}

.container {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  background-color: #f5f5f5;
}

.content {
  text-align: center;
  background-color: #fff;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

.title {
  font-size: 2em;
  font-weight: bold;
  margin-bottom: 20px;
}

.description {
  font-size: 1.2em;
  margin-bottom: 30px;
}

footer {
  text-align: center;
  padding: 10px 0;
  font-size: 0.8em;
}
</style>
</head>
<body>
<div class="container">
  <div class="content">
    <h1 style="text-align: center;">基于Python DeJavu 进音乐指纹识别，识别歌曲</h1>
    <p style="text-align: center;">识别音乐</p>
    <p style="text-align: center;">
      <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" style="text-decoration: none;">CC4.0</a>
    </p>
    <p style="text-align: center;">
      <img src="http://112firshme11224.test.upcdn.net/demos/788db197-f796-42d2-8ea5-ef655160e7c5.png" alt="图片">
    </p>
    <h2>开始</h2>
    <h3>将音频数据分析的结果存储到数据库</h3>
    <pre><code class="language-python">#!/usr/bin/python
# -*- coding: utf-8 -*-
from dejavu import Dejavu

config = {
    "database": {
        "host": "127.0.0.1",
        "user": "root",
        "passwd": "passw0rd",
        "db": "dejavu",
    },
    "database_type": "mysql",
}

# 将数据提取到Mysql （音乐的指纹）

djv = Dejavu(config)

djv.fingerprint_directory("/Users/zhangjianxin/home/mp3/", [".mp3"])
print(djv.db.get_num_fingerprints())

</code></pre>
    <h3>监听麦克风进行识别歌曲</h3>
    <pre><code class="language-python">#!/usr/bin/python
# -*- coding: utf-8 -*-


from dejavu import Dejavu
from dejavu.recognize import FileRecognizer, MicrophoneRecognizer

config = {
    "database": {
        "host": "127.0.0.1",
        "user": "root",
        "passwd": "passw0rd",
        "db": "dejavu",
    },
    "database_type": "mysql"
}
djv = Dejavu(config)

# 识别从mic输入的音频 只获得5秒的音频
secs = 5
song = djv.recognize(MicrophoneRecognizer, seconds=secs)
if song is None:
    print "No Match"
else:
    print(song)
</code></pre>
    <h2>需要用到的工具</h2>
    <pre><code class="language-bash">python 2.7

brew install portaudio
brew install ffmpeg
brew install mysql-connector-c # my_config.h
brew install mysql
#!!!  mysql-connector-c (my_config.h) ->  mysql
ln -s  ../../../../mysql-connector-c/6.1.11/include/my_config.h ./


brew link mysql # create links

pip install mysql-python
pip install numpy==1.10.2 #  版本兼容性问题
pip install PyDejavu

</code></pre>
  </div>
</div>
<footer>
  Power By Gemini TextGenerate 2024-09-16
</footer>
<script>
  // 获取当前时间
  const now = new Date();
  const hour = now.getHours();

  // 判断当前时间是否为夜间模式
  if (hour >= 18 || hour < 6) {
    // 夜间模式
    document.body.style.backgroundColor = '#111';
    document.body.style.color = '#fff';
  } else {
    // 白天模式
    document.body.style.backgroundColor = '#f5f5f5';
    document.body.style.color = '#333';
  }

  // 代码高亮
  hljs.initHighlightingOnLoad();
  Prism.highlightAll();
</script>
</html>