<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOOPS Communicator - å¢å¼ºç‰ˆ CAD æŸ¥çœ‹å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a2e;
            overflow: hidden;
        }

        #viewer-container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        #viewer {
            width: 100%;
            height: 100%;
            background: #16213e;
        }

        #toolbar {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            z-index: 1000;
            max-width: 350px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        #toolbar::-webkit-scrollbar {
            width: 8px;
        }

        #toolbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        #toolbar::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        h1 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-section {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 600;
            font-size: 14px;
        }

        input[type="text"], input[type="file"], select {
            width: 100%;
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #5568d3;
        }

        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-bottom: 8px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }

        .btn-info {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
        }

        .sample-models {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
        }

        .sample-models h3 {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
        }

        .sample-btn {
            padding: 8px;
            font-size: 12px;
            background: #28a745;
            margin-bottom: 5px;
        }

        .sample-btn:hover {
            background: #218838;
        }

        #info-panel {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 8px;
            z-index: 1000;
            max-width: 300px;
            font-size: 12px;
            color: #333;
        }

        #status {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(40, 167, 69, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            z-index: 1000;
            display: none;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        #status.loading {
            background: rgba(255, 193, 7, 0.9);
        }

        #status.error {
            background: rgba(220, 53, 69, 0.9);
        }

        .feature-list {
            margin-top: 10px;
            padding-left: 15px;
        }

        .feature-list li {
            margin-bottom: 5px;
            color: #555;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px;
            margin-top: 15px;
            border-radius: 4px;
            font-size: 12px;
            color: #856404;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .loading-animation {
            animation: pulse 1.5s ease-in-out infinite;
        }

        .tab-container {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }

        .tab {
            flex: 1;
            padding: 8px;
            background: #e9ecef;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: background 0.3s;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .model-info {
            background: #e7f3ff;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 12px;
        }

        .model-info div {
            margin-bottom: 5px;
        }

        .model-info strong {
            color: #0066cc;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 8px;
        }

        .color-picker-group {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        input[type="color"] {
            width: 60px;
            height: 40px;
            border: 2px solid #667eea;
            border-radius: 6px;
            cursor: pointer;
        }

        .slider-group {
            margin-bottom: 15px;
        }

        input[type="range"] {
            width: 100%;
            margin-top: 5px;
        }

        .slider-value {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 8px;
        }
    </style>
</head>
<body>
<div id="viewer-container">
    <div id="viewer"></div>

    <div id="toolbar">
        <h1>ğŸ”§ HOOPS å¢å¼ºæŸ¥çœ‹å™¨</h1>

        <div class="tab-container">
            <button class="tab active" onclick="switchTab('load')">åŠ è½½</button>
            <button class="tab" onclick="switchTab('view')">è§†å›¾</button>
            <button class="tab" onclick="switchTab('tools')">å·¥å…·</button>
        </div>

        <!-- åŠ è½½é€‰é¡¹å¡ -->
        <div id="load-tab" class="tab-content active">
            <div class="control-section">
                <label>ğŸ“ æ¨¡å‹ URL (.scs æ ¼å¼)ï¼š</label>
                <input type="text" id="modelUrl"
                       placeholder="https://example.com/model.scs">
            </div>
            <button onclick="loadModelFromUrl()">ğŸš€ ä» URL åŠ è½½</button>

            <div class="control-section">
                <label>ğŸ’¾ æœ¬åœ°æ–‡ä»¶ï¼š</label>
                <input type="file" id="fileInput"
                       accept=".scs,.scz,.hsf">
            </div>
            <button onclick="loadModelFromFile()">ğŸ“‚ ä»æ–‡ä»¶åŠ è½½</button>

            <div class="sample-models">
                <h3>ğŸ“¦ ç¤ºä¾‹æ¨¡å‹ï¼š</h3>
                <button class="sample-btn" onclick="loadSampleModel('bnc')">
                    BNC è¿æ¥å™¨
                </button>
                <button class="sample-btn" onclick="loadSampleModel('microengine')">
                    å¾®å‹å¼•æ“
                </button>
            </div>

            <div id="modelInfo" class="model-info" style="display: none;">
                <strong>ğŸ“Š æ¨¡å‹ä¿¡æ¯ï¼š</strong>
                <div id="nodeCount">èŠ‚ç‚¹æ•°: -</div>
                <div id="polyCount">é¢æ•°: -</div>
                <div id="fileSize">æ–‡ä»¶å¤§å°: -</div>
            </div>
        </div>

        <!-- è§†å›¾é€‰é¡¹å¡ -->
        <div id="view-tab" class="tab-content">
            <div class="button-group">
                <button class="btn-secondary" onclick="resetView()">ğŸ”„ é‡ç½®</button>
                <button class="btn-secondary" onclick="fitToView()">ğŸ“ é€‚é…</button>
            </div>

            <div class="control-section">
                <label>ğŸ¨ æ¸²æŸ“æ¨¡å¼ï¼š</label>
                <select id="drawMode" onchange="changeDrawMode()">
                    <option value="shaded">ç€è‰²æ¨¡å¼</option>
                    <option value="wireframe">çº¿æ¡†æ¨¡å¼</option>
                    <option value="hiddenline">éšè—çº¿</option>
                    <option value="shadedwireframe">ç€è‰²+çº¿æ¡†</option>
                </select>
            </div>

            <div class="control-section">
                <label>ğŸŒˆ èƒŒæ™¯é¢œè‰²ï¼š</label>
                <div class="color-picker-group">
                    <input type="color" id="bgColor1" value="#16213e"
                           onchange="updateBackground()">
                    <input type="color" id="bgColor2" value="#1a1a2e"
                           onchange="updateBackground()">
                </div>
            </div>

            <div class="control-section">
                <label>ğŸ’¡ å…‰ç…§å¼ºåº¦ï¼š
                    <span class="slider-value" id="lightValue">1.0</span>
                </label>
                <input type="range" id="lightIntensity" min="0" max="2"
                       step="0.1" value="1.0" onchange="updateLighting()">
            </div>

            <div class="button-group">
                <button class="btn-info" onclick="toggleProjection()">
                    ğŸ“· æŠ•å½±åˆ‡æ¢
                </button>
                <button class="btn-info" onclick="toggleAxis()">
                    ğŸ¯ åæ ‡è½´
                </button>
            </div>
        </div>

        <!-- å·¥å…·é€‰é¡¹å¡ -->
        <div id="tools-tab" class="tab-content">
            <div class="control-section">
                <label>ğŸ”§ æµ‹é‡å·¥å…·ï¼š</label>
                <div class="button-group">
                    <button class="btn-secondary" onclick="enableMeasure('distance')">
                        ğŸ“ è·ç¦»
                    </button>
                    <button class="btn-secondary" onclick="enableMeasure('angle')">
                        ğŸ“ è§’åº¦
                    </button>
                </div>
            </div>

            <div class="control-section">
                <label>âœ‚ï¸ å‰–åˆ‡å·¥å…·ï¼š</label>
                <div class="button-group">
                    <button class="btn-secondary" onclick="enableCuttingPlane('x')">
                        X å‰–åˆ‡
                    </button>
                    <button class="btn-secondary" onclick="enableCuttingPlane('y')">
                        Y å‰–åˆ‡
                    </button>
                    <button class="btn-secondary" onclick="enableCuttingPlane('z')">
                        Z å‰–åˆ‡
                    </button>
                    <button class="btn-danger" onclick="clearCuttingPlanes()">
                        æ¸…é™¤å‰–åˆ‡
                    </button>
                </div>
            </div>

            <div class="control-section">
                <label>ğŸ“¸ æˆªå›¾å¯¼å‡ºï¼š</label>
                <button class="btn-info" onclick="takeScreenshot()">
                    ğŸ“· æˆªå›¾ä¿å­˜
                </button>
            </div>

            <button class="btn-danger" onclick="clearModel()">
                ğŸ—‘ï¸ æ¸…é™¤æ¨¡å‹
            </button>
        </div>

        <div class="warning-box">
            âš ï¸ <strong>æç¤ºï¼š</strong> æ”¯æŒ .scsã€.sczã€.hsf æ ¼å¼æ–‡ä»¶
        </div>
    </div>

    <div id="info-panel">
        <strong>ğŸ® æ“ä½œæŒ‡å—ï¼š</strong>
        <ul class="feature-list">
            <li>å·¦é”®æ‹–åŠ¨ï¼šæ—‹è½¬æ¨¡å‹</li>
            <li>å³é”®æ‹–åŠ¨ï¼šå¹³ç§»è§†å›¾</li>
            <li>æ»šè½®ï¼šç¼©æ”¾è§†å›¾</li>
            <li>åŒå‡»ï¼šèšç„¦éƒ¨ä»¶</li>
            <li>Ctrl+å·¦é”®ï¼šå¤šé€‰</li>
        </ul>
        <strong style="margin-top: 10px; display: block;">âœ¨ å¿«æ·é”®ï¼š</strong>
        <ul class="feature-list">
            <li>F: é€‚é…è§†å›¾</li>
            <li>H: è¿”å›ä¸»è§†å›¾</li>
            <li>W: çº¿æ¡†æ¨¡å¼</li>
            <li>S: ç€è‰²æ¨¡å¼</li>
        </ul>
    </div>

    <div id="status">å‡†å¤‡å°±ç»ª</div>
</div>

<!-- HOOPS Communicator åº“ -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/techsoft3d/hoops-web-viewer@latest/hoops_web_viewer.js"></script>

<script>
    let hwv;
    let wireframeMode = false;
    let axisVisible = false;
    let projectionMode = 'perspective';
    let cuttingPlanes = [];

    // åˆå§‹åŒ–
    window.onload = function() {
        try {
            hwv = new Communicator.WebViewer({
                containerId: "viewer",
                model: "",
                rendererType: Communicator.RendererType.Client
            });

            hwv.setCallbacks({
                sceneReady: function() {
                    showStatus("æŸ¥çœ‹å™¨å·²å°±ç»ª", "success");
                    console.log("HOOPS Communicator å·²åˆå§‹åŒ–");
                    setupEnvironment();
                    setupKeyboardShortcuts();
                },

                modelLoadBegin: function() {
                    showStatus("æ­£åœ¨åŠ è½½æ¨¡å‹...", "loading");
                },

                modelLoadEnd: function() {
                    showStatus("æ¨¡å‹åŠ è½½å®Œæˆï¼", "success");
                    resetView();
                    updateModelInfo();
                },

                modelLoadFailure: function(error) {
                    showStatus("åŠ è½½å¤±è´¥: " + error, "error");
                    console.error("æ¨¡å‹åŠ è½½é”™è¯¯:", error);
                },

                modelStructureReady: function() {
                    console.log("æ¨¡å‹ç»“æ„å·²å°±ç»ª");
                }
            });

            hwv.start();

        } catch (error) {
            console.error("åˆå§‹åŒ–é”™è¯¯:", error);
            showStatus("åˆå§‹åŒ–å¤±è´¥: " + error.message, "error");
        }
    };

    // åˆ‡æ¢é€‰é¡¹å¡
    function switchTab(tabName) {
        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
        });
        event.target.classList.add('active');

        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
        });
        document.getElementById(tabName + '-tab').classList.add('active');
    }

    // è®¾ç½®ç¯å¢ƒ
    function setupEnvironment() {
        const view = hwv.view;
        view.setBackgroundColor(
            new Communicator.Color(22, 33, 62),
            new Communicator.Color(26, 26, 46)
        );
        view.setAntiAliasingMode(Communicator.AntiAliasingMode.SMAA);
    }

    // è®¾ç½®é”®ç›˜å¿«æ·é”®
    function setupKeyboardShortcuts() {
        document.addEventListener('keydown', (e) => {
            if (e.key === 'f' || e.key === 'F') {
                fitToView();
            } else if (e.key === 'h' || e.key === 'H') {
                resetView();
            } else if (e.key === 'w' || e.key === 'W') {
                document.getElementById('drawMode').value = 'wireframe';
                changeDrawMode();
            } else if (e.key === 's' || e.key === 'S') {
                document.getElementById('drawMode').value = 'shaded';
                changeDrawMode();
            }
        });
    }

    // ä» URL åŠ è½½æ¨¡å‹
    async function loadModelFromUrl() {
        const modelUrl = document.getElementById('modelUrl').value.trim();
        if (!modelUrl) {
            showStatus("è¯·è¾“å…¥æ¨¡å‹ URL", "error");
            return;
        }

        try {
            showStatus("æ­£åœ¨åŠ è½½æ¨¡å‹...", "loading");
            await hwv.model.clear();
            await hwv.model.loadSubtreeFromScsFile(hwv.model.getRootNode(), modelUrl);
            showStatus("æ¨¡å‹åŠ è½½æˆåŠŸï¼", "success");
            resetView();
        } catch (error) {
            showStatus("åŠ è½½å¤±è´¥: " + error.message, "error");
            console.error("æ¨¡å‹åŠ è½½é”™è¯¯:", error);
        }
    }

    // ä»æ–‡ä»¶åŠ è½½æ¨¡å‹
    async function loadModelFromFile() {
        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];

        if (!file) {
            showStatus("è¯·é€‰æ‹©æ–‡ä»¶", "error");
            return;
        }

        try {
            showStatus("æ­£åœ¨è¯»å–æ–‡ä»¶...", "loading");
            const arrayBuffer = await file.arrayBuffer();

            document.getElementById('fileSize').textContent =
                `æ–‡ä»¶å¤§å°: ${(file.size / 1024 / 1024).toFixed(2)} MB`;

            showStatus("æ­£åœ¨åŠ è½½æ¨¡å‹...", "loading");
            await hwv.model.clear();
            await hwv.model.loadSubtreeFromScsBuffer(
                hwv.model.getRootNode(),
                arrayBuffer
            );

            showStatus("æ¨¡å‹åŠ è½½æˆåŠŸï¼", "success");
            resetView();
        } catch (error) {
            showStatus("åŠ è½½å¤±è´¥: " + error.message, "error");
            console.error("æ–‡ä»¶åŠ è½½é”™è¯¯:", error);
        }
    }

    // åŠ è½½ç¤ºä¾‹æ¨¡å‹
    function loadSampleModel(modelName) {
        const sampleModels = {
            'bnc': 'https://cdn.jsdelivr.net/gh/techsoft3d/hoops-web-viewer@latest/models/bnc.scs',
            'microengine': 'https://filesamples.com/samples/3d/scs/sample1.scs'
        };

        const modelUrl = sampleModels[modelName];
        if (modelUrl) {
            document.getElementById('modelUrl').value = modelUrl;
            loadModelFromUrl();
        }
    }

    // æ›´æ–°æ¨¡å‹ä¿¡æ¯
    function updateModelInfo() {
        const modelInfo = document.getElementById('modelInfo');
        modelInfo.style.display = 'block';

        // è·å–æ¨¡å‹ç»Ÿè®¡ä¿¡æ¯
        const nodeCount = hwv.model.getNodeChildren(hwv.model.getRootNode()).length;
        document.getElementById('nodeCount').textContent = `èŠ‚ç‚¹æ•°: ${nodeCount}`;
    }

    // é‡ç½®è§†å›¾
    function resetView() {
        if (hwv && hwv.view) {
            hwv.view.resetCamera();
            showStatus("è§†å›¾å·²é‡ç½®", "success");
        }
    }

    // é€‚é…è§†å›¾
    function fitToView() {
        if (hwv && hwv.view) {
            hwv.view.fitWorld();
            showStatus("å·²é€‚é…è§†å›¾", "success");
        }
    }

    // æ”¹å˜ç»˜åˆ¶æ¨¡å¼
    function changeDrawMode() {
        const mode = document.getElementById('drawMode').value;
        const view = hwv.view;

        switch(mode) {
            case 'shaded':
                view.setDrawMode(Communicator.DrawMode.Shaded);
                break;
            case 'wireframe':
                view.setDrawMode(Communicator.DrawMode.Wireframe);
                break;
            case 'hiddenline':
                view.setDrawMode(Communicator.DrawMode.HiddenLine);
                break;
            case 'shadedwireframe':
                view.setDrawMode(Communicator.DrawMode.ShadedWithWireframe);
                break;
        }
        showStatus(`å·²åˆ‡æ¢åˆ°${mode}æ¨¡å¼`, "success");
    }

    // æ›´æ–°èƒŒæ™¯
    function updateBackground() {
        const color1 = document.getElementById('bgColor1').value;
        const color2 = document.getElementById('bgColor2').value;

        const c1 = hexToRgb(color1);
        const c2 = hexToRgb(color2);

        hwv.view.setBackgroundColor(
            new Communicator.Color(c1.r, c1.g, c1.b),
            new Communicator.Color(c2.r, c2.g, c2.b)
        );
    }

    // æ›´æ–°å…‰ç…§
    function updateLighting() {
        const intensity = document.getElementById('lightIntensity').value;
        document.getElementById('lightValue').textContent = intensity;
        // HOOPS çš„å…‰ç…§è°ƒæ•´éœ€è¦æ›´å¤æ‚çš„APIï¼Œè¿™é‡Œç®€åŒ–å¤„ç†
        showStatus(`å…‰ç…§å¼ºåº¦: ${intensity}`, "success");
    }

    // åˆ‡æ¢æŠ•å½±æ¨¡å¼
    function toggleProjection() {
        const camera = hwv.view.getCamera();
        if (projectionMode === 'perspective') {
            camera.setProjection(Communicator.Projection.Orthographic);
            projectionMode = 'orthographic';
            showStatus("å·²åˆ‡æ¢åˆ°æ­£äº¤æŠ•å½±", "success");
        } else {
            camera.setProjection(Communicator.Projection.Perspective);
            projectionMode = 'perspective';
            showStatus("å·²åˆ‡æ¢åˆ°é€è§†æŠ•å½±", "success");
        }
    }

    // åˆ‡æ¢åæ ‡è½´
    function toggleAxis() {
        axisVisible = !axisVisible;
        hwv.view.setAxisTriadVisibility(axisVisible);
        showStatus(axisVisible ? "åæ ‡è½´å·²æ˜¾ç¤º" : "åæ ‡è½´å·²éšè—", "success");
    }

    // å¯ç”¨æµ‹é‡å·¥å…·
    function enableMeasure(type) {
        if (type === 'distance') {
            hwv.operatorManager.set(Communicator.OperatorId.MeasurePointPointDistance, 0);
            showStatus("è·ç¦»æµ‹é‡å·¥å…·å·²å¯ç”¨", "success");
        } else if (type === 'angle') {
            hwv.operatorManager.set(Communicator.OperatorId.MeasureAngle, 0);
            showStatus("è§’åº¦æµ‹é‡å·¥å…·å·²å¯ç”¨", "success");
        }
    }

    // å¯ç”¨å‰–åˆ‡å¹³é¢
    function enableCuttingPlane(axis) {
        const plane = new Communicator.Plane();
        const center = hwv.view.getCamera().getTarget();

        switch(axis) {
            case 'x':
                plane.normal = new Communicator.Point3(1, 0, 0);
                break;
            case 'y':
                plane.normal = new Communicator.Point3(0, 1, 0);
                break;
            case 'z':
                plane.normal = new Communicator.Point3(0, 0, 1);
                break;
        }

        plane.d = -center.dot(plane.normal);
        const planeId = hwv.cuttingManager.addCuttingPlane(plane);
        cuttingPlanes.push(planeId);

        showStatus(`${axis.toUpperCase()} è½´å‰–åˆ‡å·²å¯ç”¨`, "success");
    }

    // æ¸…é™¤å‰–åˆ‡å¹³é¢
    function clearCuttingPlanes() {
        cuttingPlanes.forEach(id => {
            hwv.cuttingManager.removeCuttingPlane(id);
        });
        cuttingPlanes = [];
        showStatus("å‰–åˆ‡å¹³é¢å·²æ¸…é™¤", "success");
    }

    // æˆªå›¾
    function takeScreenshot() {
        hwv.view.requestSnapshot().then((image) => {
            const link = document.createElement('a');
            link.download = `screenshot_${Date.now()}.png`;
            link.href = image;
            link.click();
            showStatus("æˆªå›¾å·²ä¿å­˜", "success");
        });
    }

    // æ¸…é™¤æ¨¡å‹
    async function clearModel() {
        if (hwv && hwv.model) {
            try {
                await hwv.model.clear();
                document.getElementById('modelInfo').style.display = 'none';
                showStatus("æ¨¡å‹å·²æ¸…é™¤", "success");
            } catch (error) {
                showStatus("æ¸…é™¤å¤±è´¥: " + error.message, "error");
            }
        }
    }

    // æ˜¾ç¤ºçŠ¶æ€
    function showStatus(message, type) {
        const statusDiv = document.getElementById('status');
        statusDiv.textContent = message;
        statusDiv.className = type;
        statusDiv.style.display = 'block';

        if (type === 'loading') {
            statusDiv.classList.add('loading-animation');
        } else {
            statusDiv.classList.remove('loading-animation');
        }

        if (type === 'success' || type === 'error') {
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }
    }

    // è¾…åŠ©å‡½æ•°ï¼šåå…­è¿›åˆ¶è½¬ RGB
    function hexToRgb(hex) {
        const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? {
            r: parseInt(result[1], 16),
            g: parseInt(result[2], 16),
            b: parseInt(result[3], 16)
        } : null;
    }
</script>
</body>
</html>